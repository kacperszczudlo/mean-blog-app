@if (!router.url.includes('favorites')) {
    <app-add-post (postAdded)="getAll()"></app-add-post>
}

<div class="container mt-4">
    <div class="d-flex justify-content-between mb-3">
        <div>
            <label class="me-2">Filtruj po kategorii:</label>
            <select class="form-select form-select-sm d-inline-block w-auto" 
                    [(ngModel)]="selectedCategory" 
                    (change)="onCategoryChange(selectedCategory)">
              <option value="all">Wszystkie</option>
              @for (cat of categories.slice(1); track cat) {
                <option [value]="cat">{{ cat }}</option>
              }
            </select>
        </div>
        <button class="btn btn-sm btn-outline-info" (click)="sortItemsByRating()">
            <i class="fa fa-sort"></i> Sortuj według ocen ⭐
        </button>
    </div>
    
    <div class="row">
        @for (item of (items$ | filter: filterText | paginate: currentPage : itemsPerPage); track item._id) {
            
            <div class="col-12 col-md-6 col-lg-4 mb-4">
                <blog-item 
                    [title]="item.title" 
                    [text]="item.text" 
                    [image]="item.image"
                    [id]="item._id"
                    [authorId]="item.authorId"
                    [authorName]="item.authorName"
                    [category]="item.category"
                    [likes]="item.likes"
                    [likedBy]="item.likedBy"
                    [createdAt]="item.createdAt"
                    (postDeleted)="getAll()"
                    (postUpdated)="getAll()">
                </blog-item>
            </div>

        } @empty {
            <div class="col-12">
                <div class="alert alert-warning" role="alert">
                    Brak wyników lub brak postów w ulubionych.
                </div>
            </div>
        }
    </div>

    <app-pagination
        [totalItems]="(items$ | filter: filterText)?.length || 0"
        [currentPage]="currentPage"
        [itemsPerPage]="itemsPerPage"
        (pageChange)="onPageChange($event)">
    </app-pagination>
</div>